import cv2
import matplotlib.pyplot as plt
import numpy as np

# Load the captured image (assuming 'img_rgb' from previous step is available or re-load)
try:
    # If img_rgb is not in kernel state, re-load the image
    if 'img_rgb' not in locals():
        image_path = '/content/Screenshot 2025-12-17 125718.png' # Using the image path from the previous cell
        img = cv2.imread(image_path)
        if img is None:
            raise FileNotFoundError(f"Image not found at {image_path}")
        img_rgb = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

    original_height, original_width = img_rgb.shape[:2]

    # --- Affine Transformation ---
    # Define 3 points on the original image
    pts1 = np.float32([
        [50, 50],   # Top-left corner (example)
        [original_width - 50, 50], # Top-right corner (example)
        [50, original_height - 50]  # Bottom-left corner (example)
    ])

    # Define the corresponding 3 points for the transformed image
    # This defines the new position, scale, and rotation
    pts2 = np.float32([
        [10, 100],  # New position for top-left (shifted down and left)
        [original_width - 10, 50], # New position for top-right (shifted slightly right)
        [100, original_height - 100] # New position for bottom-left (shifted right and up)
    ])

    # Get the affine transformation matrix
    M = cv2.getAffineTransform(pts1, pts2)

    # Apply the affine transformation
    # The third argument is the size of the output image (width, height)
    transformed_image = cv2.warpAffine(img_rgb, M, (original_width, original_height))

    # --- Displaying the Images ---
    plt.figure(figsize=(12, 6))

    plt.subplot(1, 2, 1)
    plt.imshow(img_rgb)
    plt.title('Original Image')
    plt.axis('off')

    plt.subplot(1, 2, 2)
    plt.imshow(transformed_image)
    plt.title('Affine Transformed Image')
    plt.axis('off')

    plt.show()

except FileNotFoundError as e:
    print(f"Error: {e}. Please ensure the image file exists.")
except Exception as e:
    print(f"An error occurred: {e}")
